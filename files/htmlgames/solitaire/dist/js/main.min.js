$.fn.center=function(b){var c=window.screen.width,a=window.screen.height;return this.each(function(){$(this).css({left:((c-$(this).width())/2)+"px"})})};var WarpKlondikeMain=(function(a){function b(){$("#playground").css("margin-top",parseInt((window.innerHeight-parseInt($("#playground").height()))/2)+"px");$("#autoFlip").bind(EventsManager.EVENT_CHANGE,function(){a.gameOptions.autoFlip=($(this).attr("checked"))});$("#sound").bind(EventsManager.EVENT_CHANGE,function(){a.gameOptions.sound=($(this).attr("checked"))});$("#autoPlay").bind(EventsManager.EVENT_CHANGE,function(){a.gameOptions.autoPlay=($(this).attr("checked"))});$(".ok").bind(EventsManager.EVENT_UP,function(){if($(this).parent().attr("id")==="options"){StateManager.setGameOptions(a.gameOptions);StateManager.saveGameOptions()}$(this).parent().removeClass("flipped");$(".icon").removeClass("over");a.togglePauseGame(false);$("#shadow").fadeOut()});$(".themeSelect").click(function(c){var d=$(this).find("img").attr("alt");$("ul#themeList li").removeClass("selected");$(this).parent().addClass("selected");$("#themeCSS").attr("href","css/themes/"+d+"/theme.css");a.gameOptions.theme=d;return false});$("#showScores").bind(EventsManager.EVENT_UP,function(){if($("#scores").hasClass("flipped")){a.togglePauseGame(false)}else{a.togglePauseGame(true)}$("#options").removeClass("flipped");$("#shadow").fadeIn("normal",function(){$("#scores").toggleClass("flipped")});return false});$("#menuToggle").bind(EventsManager.EVENT_UP,function(){$("#scores").removeClass("flipped");if($("#options").hasClass("flipped")){StateManager.setGameOptions(a.gameOptions);StateManager.saveGameOptions();a.togglePauseGame(false)}else{a.togglePauseGame(true)}$(this).removeClass("over");$("#shadow").fadeIn("normal",function(){$("#options").toggleClass("flipped")});return false});if(!CM.isiOS){$(".icon").bind(EventsManager.EVENT_OVER,function(){$(this).addClass("over")}).bind(EventsManager.EVENT_OUT,function(){$(this).removeClass("over")})}}return{status:0,setStatus:function(c){this.status=c},init:function(){SoundManager.init();EventsManager.init();b();$(function(){Particles.init(32);setTimeout(function(){$(".dialog").center()},1000)});StateManager.init("1.0",function(d,c,e){Console.log(d);Console.log(e);Console.log(c);a.init(d,c);if(a.gameStats.status==G_PAUSED){setTimeout(function(){$.gritter.add({title:"Information",text:'A previous game state has been saved. Would you like to resume it ?<br /><br /><a class="restoreGame" href="#">Click here to restore it</a>',image:"img/hd/icons/brainstorming.png",time:5000,fade_in_speed:"fast",fade_out_speed:400})},1000)}a.shuffle();WarpKlondikeMain.setOptions();WarpKlondikeMain.setScores(e);a.runGame()})},setTheme:function(d){var c=$("#themeCSS");if(c.length){c.attr("href","css/themes/"+d+"/theme.css")}else{$("<link/>").attr({rel:"stylesheet",type:"text/css",href:"css/themes/"+d+"/theme.css",id:"themeCSS"}).appendTo("head")}$("ul#themeList li").removeClass("selected");$("#themeList").find("img[alt="+d+"]").parent().parent().addClass("selected")},setOptions:function(){if(a.gameOptions.autoFlip){$("#autoFlip").attr("checked","checked")}if(a.gameOptions.autoPlay){$("#autoPlay").attr("checked","checked")}if(a.gameOptions.sound){$("#sound").attr("checked","checked")}if(!a.gameOptions.theme){a.gameOptions.theme="fantasy"}WarpKlondikeMain.setTheme(a.gameOptions.theme)},setScores:function(e){if(typeof e!=="object"){return}var c=$("#scores ul");$("#scores ul li").remove();for(var d=0;d<e.length;d++){$("<li/>").append('<span class="rank">'+(d+1)+'</span><span class="nick">'+e[d].nick+'</span><span class="score">'+e[d].score+"</span>").appendTo(c)}}}})(game);